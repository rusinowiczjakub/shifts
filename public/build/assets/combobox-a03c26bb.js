import{r as f,f as ze,e as j}from"./app-fcf0e4b5.js";import{s as Se,l as F,o as x,O as be,U as J,u as H,p as ce,g as De,e as te,x as Fe,C as W,y as Y,d as Ae,c as me}from"./open-closed-2c09b590.js";import{o as ke,e as Le,f as _e,s as je,I as G,n as Ne,m as ge,b as L,t as he,r as Be,g as Ve,a as Ke}from"./keyboard-968ae16c.js";/**
 * react-virtual
 *
 * Copyright (c) TanStack
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function ne(){return ne=Object.assign?Object.assign.bind():function(t){for(var i=1;i<arguments.length;i++){var e=arguments[i];for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])}return t},ne.apply(this,arguments)}/**
 * virtual-core
 *
 * Copyright (c) TanStack
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function oe(){return oe=Object.assign?Object.assign.bind():function(t){for(var i=1;i<arguments.length;i++){var e=arguments[i];for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])}return t},oe.apply(this,arguments)}/**
 * virtual-core
 *
 * Copyright (c) TanStack
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function q(t,i,e){var n,r=(n=e.initialDeps)!=null?n:[],o;return function(){var l;e.key&&e.debug!=null&&e.debug()&&(l=Date.now());var u=t(),c=u.length!==r.length||u.some(function(b,g){return r[g]!==b});if(!c)return o;r=u;var s;if(e.key&&e.debug!=null&&e.debug()&&(s=Date.now()),o=i.apply(void 0,u),e.key&&e.debug!=null&&e.debug()){var p=Math.round((Date.now()-l)*100)/100,v=Math.round((Date.now()-s)*100)/100,R=v/16,a=function(g,O){for(g=String(g);g.length<O;)g=" "+g;return g};console.info("%c⏱ "+a(v,5)+" /"+a(p,5)+" ms",`
            font-size: .6rem;
            font-weight: bold;
            color: hsl(`+Math.max(0,Math.min(120-120*R,120))+"deg 100% 31%);",e==null?void 0:e.key)}return e==null||e.onChange==null||e.onChange(o),o}}function ue(t,i){if(t===void 0)throw new Error("Unexpected undefined"+(i?": "+i:""));return t}var Ue=function(i,e){return Math.abs(i-e)<1};/**
 * virtual-core
 *
 * Copyright (c) TanStack
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */var qe=function(i){return i},He=function(i){for(var e=Math.max(i.startIndex-i.overscan,0),n=Math.min(i.endIndex+i.overscan,i.count-1),r=[],o=e;o<=n;o++)r.push(o);return r},Je=function(i,e){var n=i.scrollElement;if(n){var r=function(u){var c=u.width,s=u.height;e({width:Math.round(c),height:Math.round(s)})};r(n.getBoundingClientRect());var o=new ResizeObserver(function(l){var u=l[0];if(u!=null&&u.borderBoxSize){var c=u.borderBoxSize[0];if(c){r({width:c.inlineSize,height:c.blockSize});return}}r(n.getBoundingClientRect())});return o.observe(n,{box:"border-box"}),function(){o.unobserve(n)}}},We=function(i,e){var n=i.scrollElement;if(n){var r=function(){e(n[i.options.horizontal?"scrollLeft":"scrollTop"])};return r(),n.addEventListener("scroll",r,{passive:!0}),function(){n.removeEventListener("scroll",r)}}},Xe=function(i,e,n){if(e!=null&&e.borderBoxSize){var r=e.borderBoxSize[0];if(r){var o=Math.round(r[n.options.horizontal?"inlineSize":"blockSize"]);return o}}return Math.round(i.getBoundingClientRect()[n.options.horizontal?"width":"height"])},Ye=function(i,e,n){var r,o,l=e.adjustments,u=l===void 0?0:l,c=e.behavior,s=i+u;(r=n.scrollElement)==null||r.scrollTo==null||r.scrollTo((o={},o[n.options.horizontal?"left":"top"]=s,o.behavior=c,o))},Ge=function(i){var e=this;this.unsubs=[],this.scrollElement=null,this.isScrolling=!1,this.isScrollingTimeoutId=null,this.scrollToIndexTimeoutId=null,this.measurementsCache=[],this.itemSizeCache=new Map,this.pendingMeasuredCacheIndexes=[],this.scrollDirection=null,this.scrollAdjustments=0,this.measureElementCache=new Map,this.observer=function(){var n=null,r=function(){return n||(typeof ResizeObserver<"u"?n=new ResizeObserver(function(l){l.forEach(function(u){e._measureElement(u.target,u)})}):null)};return{disconnect:function(){var l;return(l=r())==null?void 0:l.disconnect()},observe:function(l){var u;return(u=r())==null?void 0:u.observe(l,{box:"border-box"})},unobserve:function(l){var u;return(u=r())==null?void 0:u.unobserve(l)}}}(),this.range=null,this.setOptions=function(n){Object.entries(n).forEach(function(r){var o=r[0],l=r[1];typeof l>"u"&&delete n[o]}),e.options=oe({debug:!1,initialOffset:0,overscan:1,paddingStart:0,paddingEnd:0,scrollPaddingStart:0,scrollPaddingEnd:0,horizontal:!1,getItemKey:qe,rangeExtractor:He,onChange:function(){},measureElement:Xe,initialRect:{width:0,height:0},scrollMargin:0,scrollingDelay:150,indexAttribute:"data-index",initialMeasurementsCache:[],lanes:1},n)},this.notify=function(n){e.options.onChange==null||e.options.onChange(e,n)},this.maybeNotify=q(function(){return e.calculateRange(),[e.isScrolling,e.range?e.range.startIndex:null,e.range?e.range.endIndex:null]},function(n){e.notify(n)},{key:!1,debug:function(){return e.options.debug},initialDeps:[this.isScrolling,this.range?this.range.startIndex:null,this.range?this.range.endIndex:null]}),this.cleanup=function(){e.unsubs.filter(Boolean).forEach(function(n){return n()}),e.unsubs=[],e.scrollElement=null},this._didMount=function(){return e.measureElementCache.forEach(e.observer.observe),function(){e.observer.disconnect(),e.cleanup()}},this._willUpdate=function(){var n=e.options.getScrollElement();e.scrollElement!==n&&(e.cleanup(),e.scrollElement=n,e._scrollToOffset(e.scrollOffset,{adjustments:void 0,behavior:void 0}),e.unsubs.push(e.options.observeElementRect(e,function(r){e.scrollRect=r,e.maybeNotify()})),e.unsubs.push(e.options.observeElementOffset(e,function(r){e.scrollAdjustments=0,e.scrollOffset!==r&&(e.isScrollingTimeoutId!==null&&(clearTimeout(e.isScrollingTimeoutId),e.isScrollingTimeoutId=null),e.isScrolling=!0,e.scrollDirection=e.scrollOffset<r?"forward":"backward",e.scrollOffset=r,e.maybeNotify(),e.isScrollingTimeoutId=setTimeout(function(){e.isScrollingTimeoutId=null,e.isScrolling=!1,e.scrollDirection=null,e.maybeNotify()},e.options.scrollingDelay))})))},this.getSize=function(){return e.scrollRect[e.options.horizontal?"width":"height"]},this.memoOptions=q(function(){return[e.options.count,e.options.paddingStart,e.options.scrollMargin,e.options.getItemKey]},function(n,r,o,l){return e.pendingMeasuredCacheIndexes=[],{count:n,paddingStart:r,scrollMargin:o,getItemKey:l}},{key:!1}),this.getFurthestMeasurement=function(n,r){for(var o=new Map,l=new Map,u=r-1;u>=0;u--){var c=n[u];if(!o.has(c.lane)){var s=l.get(c.lane);if(s==null||c.end>s.end?l.set(c.lane,c):c.end<s.end&&o.set(c.lane,!0),o.size===e.options.lanes)break}}return l.size===e.options.lanes?Array.from(l.values()).sort(function(p,v){return p.end-v.end})[0]:void 0},this.getMeasurements=q(function(){return[e.memoOptions(),e.itemSizeCache]},function(n,r){var o=n.count,l=n.paddingStart,u=n.scrollMargin,c=n.getItemKey,s=e.pendingMeasuredCacheIndexes.length>0?Math.min.apply(Math,e.pendingMeasuredCacheIndexes):0;e.pendingMeasuredCacheIndexes=[];for(var p=e.measurementsCache.slice(0,s),v=s;v<o;v++){var R=c(v),a=e.options.lanes===1?p[v-1]:e.getFurthestMeasurement(p,v),b=a?a.end:l+u,g=r.get(R),O=typeof g=="number"?g:e.options.estimateSize(v),h=b+O,M=a?a.lane:v%e.options.lanes;p[v]={index:v,start:b,size:O,end:h,key:R,lane:M}}return e.measurementsCache=p,p},{key:!1,debug:function(){return e.options.debug}}),this.calculateRange=q(function(){return[e.getMeasurements(),e.getSize(),e.scrollOffset]},function(n,r,o){return e.range=n.length>0&&r>0?Qe({measurements:n,outerSize:r,scrollOffset:o}):null},{key:!1,debug:function(){return e.options.debug}}),this.getIndexes=q(function(){return[e.options.rangeExtractor,e.calculateRange(),e.options.overscan,e.options.count]},function(n,r,o,l){return r===null?[]:n(oe({},r,{overscan:o,count:l}))},{key:!1,debug:function(){return e.options.debug}}),this.indexFromElement=function(n){var r=e.options.indexAttribute,o=n.getAttribute(r);return o?parseInt(o,10):(console.warn("Missing attribute name '"+r+"={index}' on measured element."),-1)},this._measureElement=function(n,r){var o=e.measurementsCache[e.indexFromElement(n)];if(!o||!n.isConnected){e.measureElementCache.forEach(function(c,s){c===n&&(e.observer.unobserve(n),e.measureElementCache.delete(s))});return}var l=e.measureElementCache.get(o.key);l!==n&&(l&&e.observer.unobserve(l),e.observer.observe(n),e.measureElementCache.set(o.key,n));var u=e.options.measureElement(n,r,e);e.resizeItem(o,u)},this.resizeItem=function(n,r){var o,l=(o=e.itemSizeCache.get(n.key))!=null?o:n.size,u=r-l;u!==0&&(n.start<e.scrollOffset&&e._scrollToOffset(e.scrollOffset,{adjustments:e.scrollAdjustments+=u,behavior:void 0}),e.pendingMeasuredCacheIndexes.push(n.index),e.itemSizeCache=new Map(e.itemSizeCache.set(n.key,r)),e.notify(!1))},this.measureElement=function(n){n&&e._measureElement(n,void 0)},this.getVirtualItems=q(function(){return[e.getIndexes(),e.getMeasurements()]},function(n,r){for(var o=[],l=0,u=n.length;l<u;l++){var c=n[l],s=r[c];o.push(s)}return o},{key:!1,debug:function(){return e.options.debug}}),this.getVirtualItemForOffset=function(n){var r=e.getMeasurements();return ue(r[Re(0,r.length-1,function(o){return ue(r[o]).start},n)])},this.getOffsetForAlignment=function(n,r){var o=e.getSize();r==="auto"&&(n<=e.scrollOffset?r="start":n>=e.scrollOffset+o?r="end":r="start"),r==="start"?n=n:r==="end"?n=n-o:r==="center"&&(n=n-o/2);var l=e.options.horizontal?"scrollWidth":"scrollHeight",u=e.scrollElement?"document"in e.scrollElement?e.scrollElement.document.documentElement[l]:e.scrollElement[l]:0,c=u-e.getSize();return Math.max(Math.min(c,n),0)},this.getOffsetForIndex=function(n,r){r===void 0&&(r="auto"),n=Math.max(0,Math.min(n,e.options.count-1));var o=ue(e.getMeasurements()[n]);if(r==="auto")if(o.end>=e.scrollOffset+e.getSize()-e.options.scrollPaddingEnd)r="end";else if(o.start<=e.scrollOffset+e.options.scrollPaddingStart)r="start";else return[e.scrollOffset,r];var l=r==="end"?o.end+e.options.scrollPaddingEnd:o.start-e.options.scrollPaddingStart;return[e.getOffsetForAlignment(l,r),r]},this.isDynamicMode=function(){return e.measureElementCache.size>0},this.cancelScrollToIndex=function(){e.scrollToIndexTimeoutId!==null&&(clearTimeout(e.scrollToIndexTimeoutId),e.scrollToIndexTimeoutId=null)},this.scrollToOffset=function(n,r){var o=r===void 0?{}:r,l=o.align,u=l===void 0?"start":l,c=o.behavior;e.cancelScrollToIndex(),c==="smooth"&&e.isDynamicMode()&&console.warn("The `smooth` scroll behavior is not fully supported with dynamic size."),e._scrollToOffset(e.getOffsetForAlignment(n,u),{adjustments:void 0,behavior:c})},this.scrollToIndex=function(n,r){var o=r===void 0?{}:r,l=o.align,u=l===void 0?"auto":l,c=o.behavior;n=Math.max(0,Math.min(n,e.options.count-1)),e.cancelScrollToIndex(),c==="smooth"&&e.isDynamicMode()&&console.warn("The `smooth` scroll behavior is not fully supported with dynamic size.");var s=e.getOffsetForIndex(n,u),p=s[0],v=s[1];e._scrollToOffset(p,{adjustments:void 0,behavior:c}),c!=="smooth"&&e.isDynamicMode()&&(e.scrollToIndexTimeoutId=setTimeout(function(){e.scrollToIndexTimeoutId=null;var R=e.measureElementCache.has(e.options.getItemKey(n));if(R){var a=e.getOffsetForIndex(n,v),b=a[0];Ue(b,e.scrollOffset)||e.scrollToIndex(n,{align:v,behavior:c})}else e.scrollToIndex(n,{align:v,behavior:c})}))},this.scrollBy=function(n,r){var o=r===void 0?{}:r,l=o.behavior;e.cancelScrollToIndex(),l==="smooth"&&e.isDynamicMode()&&console.warn("The `smooth` scroll behavior is not fully supported with dynamic size."),e._scrollToOffset(e.scrollOffset+n,{adjustments:void 0,behavior:l})},this.getTotalSize=function(){var n;return(((n=e.getMeasurements()[e.options.count-1])==null?void 0:n.end)||e.options.paddingStart)-e.options.scrollMargin+e.options.paddingEnd},this._scrollToOffset=function(n,r){var o=r.adjustments,l=r.behavior;e.options.scrollToFn(n,{behavior:l,adjustments:o},e)},this.measure=function(){e.itemSizeCache=new Map,e.notify(!1)},this.setOptions(i),this.scrollRect=this.options.initialRect,this.scrollOffset=this.options.initialOffset,this.measurementsCache=this.options.initialMeasurementsCache,this.measurementsCache.forEach(function(n){e.itemSizeCache.set(n.key,n.size)}),this.maybeNotify()},Re=function(i,e,n,r){for(;i<=e;){var o=(i+e)/2|0,l=n(o);if(l<r)i=o+1;else if(l>r)e=o-1;else return o}return i>0?i-1:0};function Qe(t){for(var i=t.measurements,e=t.outerSize,n=t.scrollOffset,r=i.length-1,o=function(s){return i[s].start},l=Re(0,r,o,n),u=l;u<r&&i[u].end<n+e;)u++;return{startIndex:l,endIndex:u}}/**
 * react-virtual
 *
 * Copyright (c) TanStack
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */var Ze=typeof document<"u"?f.useLayoutEffect:f.useEffect;function et(t){var i=f.useReducer(function(){return{}},{})[1],e=ne({},t,{onChange:function(l,u){u?ze.flushSync(i):i(),t.onChange==null||t.onChange(l,u)}}),n=f.useState(function(){return new Ge(e)}),r=n[0];return r.setOptions(e),f.useEffect(function(){return r._didMount()},[]),Ze(function(){return r._willUpdate()}),r}function tt(t){return et(ne({observeElementRect:Je,observeElementOffset:We,scrollToFn:Ye},t))}function de(t,i){let[e,n]=f.useState(t),r=Se(t);return F(()=>n(r.current),[r,n,...i]),e}function nt(t,i,e){let[n,r]=f.useState(e),o=t!==void 0,l=f.useRef(o),u=f.useRef(!1),c=f.useRef(!1);return o&&!l.current&&!u.current?(u.current=!0,l.current=o,console.error("A component is changing from uncontrolled to controlled. This may be caused by the value changing from undefined to a defined value, which should not happen.")):!o&&l.current&&!c.current&&(c.current=!0,l.current=o,console.error("A component is changing from controlled to uncontrolled. This may be caused by the value changing from a defined value to undefined, which should not happen.")),[o?t:n,x(s=>(o||r(s),i==null?void 0:i(s)))]}function xe(t){var i;if(t.type)return t.type;let e=(i=t.as)!=null?i:"button";if(typeof e=="string"&&e.toLowerCase()==="button")return"button"}function ot(t,i){let[e,n]=f.useState(()=>xe(t));return F(()=>{n(xe(t))},[t.type,t.as]),F(()=>{e||i.current&&i.current instanceof HTMLButtonElement&&!i.current.hasAttribute("type")&&n("button")},[e,i]),e}function Oe(t){return[t.screenX,t.screenY]}function rt(){let t=f.useRef([-1,-1]);return{wasMoved(i){let e=Oe(i);return t.current[0]===e[0]&&t.current[1]===e[1]?!1:(t.current=e,!0)},update(i){t.current=Oe(i)}}}function it({container:t,accept:i,walk:e,enabled:n=!0}){let r=f.useRef(i),o=f.useRef(e);f.useEffect(()=>{r.current=i,o.current=e},[i,e]),F(()=>{if(!t||!n)return;let l=ke(t);if(!l)return;let u=r.current,c=o.current,s=Object.assign(v=>u(v),{acceptNode:u}),p=l.createTreeWalker(t,NodeFilter.SHOW_ELEMENT,s,!1);for(;p.nextNode();)c(p.currentNode)},[t,n,r,o])}function lt(t){throw new Error("Unexpected object: "+t)}var T=(t=>(t[t.First=0]="First",t[t.Previous=1]="Previous",t[t.Next=2]="Next",t[t.Last=3]="Last",t[t.Specific=4]="Specific",t[t.Nothing=5]="Nothing",t))(T||{});function Ie(t,i){let e=i.resolveItems();if(e.length<=0)return null;let n=i.resolveActiveIndex(),r=n??-1;switch(t.focus){case 0:{for(let o=0;o<e.length;++o)if(!i.resolveDisabled(e[o],o,e))return o;return n}case 1:{for(let o=r-1;o>=0;--o)if(!i.resolveDisabled(e[o],o,e))return o;return n}case 2:{for(let o=r+1;o<e.length;++o)if(!i.resolveDisabled(e[o],o,e))return o;return n}case 3:{for(let o=e.length-1;o>=0;--o)if(!i.resolveDisabled(e[o],o,e))return o;return n}case 4:{for(let o=0;o<e.length;++o)if(i.resolveId(e[o],o,e)===t.id)return o;return n}case 5:return null;default:lt(t)}}function ye(t={},i=null,e=[]){for(let[n,r]of Object.entries(t))Te(e,Ce(i,n),r);return e}function Ce(t,i){return t?t+"["+i+"]":i}function Te(t,i,e){if(Array.isArray(e))for(let[n,r]of e.entries())Te(t,Ce(i,n.toString()),r);else e instanceof Date?t.push([i,e.toISOString()]):typeof e=="boolean"?t.push([i,e?"1":"0"]):typeof e=="string"?t.push([i,e]):typeof e=="number"?t.push([i,`${e}`]):e==null?t.push([i,""]):ye(e,i,t)}var at=(t=>(t[t.Open=0]="Open",t[t.Closed=1]="Closed",t))(at||{}),ut=(t=>(t[t.Single=0]="Single",t[t.Multi=1]="Multi",t))(ut||{}),st=(t=>(t[t.Pointer=0]="Pointer",t[t.Focus=1]="Focus",t[t.Other=2]="Other",t))(st||{}),ct=(t=>(t[t.OpenCombobox=0]="OpenCombobox",t[t.CloseCombobox=1]="CloseCombobox",t[t.GoToOption=2]="GoToOption",t[t.RegisterOption=3]="RegisterOption",t[t.UnregisterOption=4]="UnregisterOption",t[t.RegisterLabel=5]="RegisterLabel",t[t.SetActivationTrigger=6]="SetActivationTrigger",t[t.UpdateVirtualOptions=7]="UpdateVirtualOptions",t))(ct||{});function se(t,i=e=>e){let e=t.activeOptionIndex!==null?t.options[t.activeOptionIndex]:null,n=i(t.options.slice()),r=n.length>0&&n[0].dataRef.current.order!==null?n.sort((l,u)=>l.dataRef.current.order-u.dataRef.current.order):Ke(n,l=>l.dataRef.current.domRef.current),o=e?r.indexOf(e):null;return o===-1&&(o=null),{options:r,activeOptionIndex:o}}let dt={1(t){var i;return(i=t.dataRef.current)!=null&&i.disabled||t.comboboxState===1?t:{...t,activeOptionIndex:null,comboboxState:1}},0(t){var i,e;if((i=t.dataRef.current)!=null&&i.disabled||t.comboboxState===0)return t;if((e=t.dataRef.current)!=null&&e.value){let n=t.dataRef.current.calculateIndex(t.dataRef.current.value);if(n!==-1)return{...t,activeOptionIndex:n,comboboxState:0}}return{...t,comboboxState:0}},2(t,i){var e,n,r,o,l;if((e=t.dataRef.current)!=null&&e.disabled||(n=t.dataRef.current)!=null&&n.optionsRef.current&&!((r=t.dataRef.current)!=null&&r.optionsPropsRef.current.static)&&t.comboboxState===1)return t;if(t.virtual){let p=i.focus===T.Specific?i.idx:Ie(i,{resolveItems:()=>t.virtual.options,resolveActiveIndex:()=>{var R,a;return(a=(R=t.activeOptionIndex)!=null?R:t.virtual.options.findIndex(b=>!t.virtual.disabled(b)))!=null?a:null},resolveDisabled:t.virtual.disabled,resolveId(){throw new Error("Function not implemented.")}}),v=(o=i.trigger)!=null?o:2;return t.activeOptionIndex===p&&t.activationTrigger===v?t:{...t,activeOptionIndex:p,activationTrigger:v}}let u=se(t);if(u.activeOptionIndex===null){let p=u.options.findIndex(v=>!v.dataRef.current.disabled);p!==-1&&(u.activeOptionIndex=p)}let c=i.focus===T.Specific?i.idx:Ie(i,{resolveItems:()=>u.options,resolveActiveIndex:()=>u.activeOptionIndex,resolveId:p=>p.id,resolveDisabled:p=>p.dataRef.current.disabled}),s=(l=i.trigger)!=null?l:2;return t.activeOptionIndex===c&&t.activationTrigger===s?t:{...t,...u,activeOptionIndex:c,activationTrigger:s}},3:(t,i)=>{var e,n,r;if((e=t.dataRef.current)!=null&&e.virtual)return{...t,options:[...t.options,i.payload]};let o=i.payload,l=se(t,c=>(c.push(o),c));t.activeOptionIndex===null&&(n=t.dataRef.current)!=null&&n.isSelected(i.payload.dataRef.current.value)&&(l.activeOptionIndex=l.options.indexOf(o));let u={...t,...l,activationTrigger:2};return(r=t.dataRef.current)!=null&&r.__demoMode&&t.dataRef.current.value===void 0&&(u.activeOptionIndex=0),u},4:(t,i)=>{var e;if((e=t.dataRef.current)!=null&&e.virtual)return{...t,options:t.options.filter(r=>r.id!==i.id)};let n=se(t,r=>{let o=r.findIndex(l=>l.id===i.id);return o!==-1&&r.splice(o,1),r});return{...t,...n,activationTrigger:2}},5:(t,i)=>t.labelId===i.id?t:{...t,labelId:i.id},6:(t,i)=>t.activationTrigger===i.trigger?t:{...t,activationTrigger:i.trigger},7:(t,i)=>{var e;if(((e=t.virtual)==null?void 0:e.options)===i.options)return t;let n=t.activeOptionIndex;if(t.activeOptionIndex!==null){let r=i.options.indexOf(t.virtual.options[t.activeOptionIndex]);r!==-1?n=r:n=null}return{...t,activeOptionIndex:n,virtual:Object.assign({},t.virtual,{options:i.options})}}},fe=f.createContext(null);fe.displayName="ComboboxActionsContext";function Q(t){let i=f.useContext(fe);if(i===null){let e=new Error(`<${t} /> is missing a parent <Combobox /> component.`);throw Error.captureStackTrace&&Error.captureStackTrace(e,Q),e}return i}let Ee=f.createContext(null);function ft(t){var i;let e=B("VirtualProvider"),[n,r]=f.useMemo(()=>{let c=e.optionsRef.current;if(!c)return[0,0];let s=window.getComputedStyle(c);return[parseFloat(s.paddingBlockStart||s.paddingTop),parseFloat(s.paddingBlockEnd||s.paddingBottom)]},[e.optionsRef.current]),o=tt({scrollPaddingStart:n,scrollPaddingEnd:r,count:e.virtual.options.length,estimateSize(){return 40},getScrollElement(){var c;return(c=e.optionsRef.current)!=null?c:null},overscan:12}),[l,u]=f.useState(0);return F(()=>{u(c=>c+1)},[(i=e.virtual)==null?void 0:i.options]),j.createElement(Ee.Provider,{value:o},j.createElement("div",{style:{position:"relative",width:"100%",height:`${o.getTotalSize()}px`},ref:c=>{if(c){if(typeof process<"u"&&{}.JEST_WORKER_ID!==void 0||e.activationTrigger===0)return;e.activeOptionIndex!==null&&e.virtual.options.length>e.activeOptionIndex&&o.scrollToIndex(e.activeOptionIndex)}}},o.getVirtualItems().map(c=>{var s;return j.createElement(f.Fragment,{key:c.key},j.cloneElement((s=t.children)==null?void 0:s.call(t,{option:e.virtual.options[c.index],open:e.comboboxState===0}),{key:`${l}-${c.key}`,"data-index":c.index,"aria-setsize":e.virtual.options.length,"aria-posinset":c.index+1,style:{position:"absolute",top:0,left:0,transform:`translateY(${c.start}px)`,overflowAnchor:"none"}}))})))}let pe=f.createContext(null);pe.displayName="ComboboxDataContext";function B(t){let i=f.useContext(pe);if(i===null){let e=new Error(`<${t} /> is missing a parent <Combobox /> component.`);throw Error.captureStackTrace&&Error.captureStackTrace(e,B),e}return i}function pt(t,i){return H(i.type,dt,t,i)}let vt=f.Fragment;function bt(t,i){let{value:e,defaultValue:n,onChange:r,form:o,name:l,by:u=null,disabled:c=!1,__demoMode:s=!1,nullable:p=!1,multiple:v=!1,immediate:R=!1,virtual:a=null,...b}=t,g=!1,O=null,[h=v?[]:void 0,M]=nt(e,r,n),[w,P]=f.useReducer(pt,{dataRef:f.createRef(),comboboxState:s?0:1,options:[],virtual:null,activeOptionIndex:null,activationTrigger:2,labelId:null}),z=f.useRef(!1),V=f.useRef({static:!1,hold:!1}),K=f.useRef(null),U=f.useRef(null),X=f.useRef(null),y=f.useRef(null),S=x(typeof u=="string"?(m,I)=>{let D=u;return(m==null?void 0:m[D])===(I==null?void 0:I[D])}:u??((m,I)=>m===I)),A=x(m=>w.options.findIndex(I=>S(I.dataRef.current.value,m))),re=f.useCallback(m=>H(d.mode,{1:()=>h.some(I=>S(I,m)),0:()=>S(h,m)}),[h]),ie=x(m=>w.activeOptionIndex===A(m)),d=f.useMemo(()=>({...w,immediate:g,optionsPropsRef:V,labelRef:K,inputRef:U,buttonRef:X,optionsRef:y,value:h,defaultValue:n,disabled:c,mode:v?1:0,virtual:w.virtual,get activeOptionIndex(){if(z.current&&w.activeOptionIndex===null&&w.options.length>0){let m=w.options.findIndex(I=>!I.dataRef.current.disabled);if(m!==-1)return m}return w.activeOptionIndex},calculateIndex:A,compare:S,isSelected:re,isActive:ie,nullable:p,__demoMode:s}),[h,n,c,v,p,s,w,O]);F(()=>{},[O,void 0]),F(()=>{w.dataRef.current=d},[d]),Le([d.buttonRef,d.inputRef,d.optionsRef],()=>ae.closeCombobox(),d.comboboxState===0);let $=f.useMemo(()=>{var m,I,D;return{open:d.comboboxState===0,disabled:c,activeIndex:d.activeOptionIndex,activeOption:d.activeOptionIndex===null?null:d.virtual?d.virtual.options[(m=d.activeOptionIndex)!=null?m:0]:(D=(I=d.options[d.activeOptionIndex])==null?void 0:I.dataRef.current.value)!=null?D:null,value:h}},[d,c,h]),E=x(()=>{if(d.activeOptionIndex!==null){if(d.virtual)le(d.virtual.options[d.activeOptionIndex]);else{let{dataRef:m}=d.options[d.activeOptionIndex];le(m.current.value)}ae.goToOption(T.Specific,d.activeOptionIndex)}}),_=x(()=>{P({type:0}),z.current=!0}),C=x(()=>{P({type:1}),z.current=!1}),k=x((m,I,D)=>(z.current=!1,m===T.Specific?P({type:2,focus:T.Specific,idx:I,trigger:D}):P({type:2,focus:m,trigger:D}))),N=x((m,I)=>(P({type:3,payload:{id:m,dataRef:I}}),()=>{d.isActive(I.current.value)&&(z.current=!0),P({type:4,id:m})})),Me=x(m=>(P({type:5,id:m}),()=>P({type:5,id:null}))),le=x(m=>H(d.mode,{0(){return M==null?void 0:M(m)},1(){let I=d.value.slice(),D=I.findIndex(ee=>S(ee,m));return D===-1?I.push(m):I.splice(D,1),M==null?void 0:M(I)}})),we=x(m=>{P({type:6,trigger:m})}),ae=f.useMemo(()=>({onChange:le,registerOption:N,registerLabel:Me,goToOption:k,closeCombobox:C,openCombobox:_,setActivationTrigger:we,selectActiveOption:E}),[]),$e=i===null?{}:{ref:i},Z=f.useRef(null),Pe=ce();return f.useEffect(()=>{Z.current&&n!==void 0&&Pe.addEventListener(Z.current,"reset",()=>{M==null||M(n)})},[Z,M]),j.createElement(fe.Provider,{value:ae},j.createElement(pe.Provider,{value:d},j.createElement(De,{value:H(d.comboboxState,{0:te.Open,1:te.Closed})},l!=null&&h!=null&&ye({[l]:h}).map(([m,I],D)=>j.createElement(_e,{features:je.Hidden,ref:D===0?ee=>{var ve;Z.current=(ve=ee==null?void 0:ee.closest("form"))!=null?ve:null}:void 0,...Fe({key:m,as:"input",type:"hidden",hidden:!0,readOnly:!0,form:o,name:m,value:I})})),W({ourProps:$e,theirProps:b,slot:$,defaultTag:vt,name:"Combobox"}))))}let mt="input";function gt(t,i){var e,n,r,o,l;let u=G(),{id:c=`headlessui-combobox-input-${u}`,onChange:s,displayValue:p,type:v="text",...R}=t,a=B("Combobox.Input"),b=Q("Combobox.Input"),g=Y(a.inputRef,i),O=Ne(a.inputRef),h=f.useRef(!1),M=ce(),w=x(()=>{b.onChange(null),a.optionsRef.current&&(a.optionsRef.current.scrollTop=0),b.goToOption(T.Nothing)}),P=function(){var d;return typeof p=="function"&&a.value!==void 0?(d=p(a.value))!=null?d:"":typeof a.value=="string"?a.value:""}();ge(([d,$],[E,_])=>{if(h.current)return;let C=a.inputRef.current;C&&((_===0&&$===1||d!==E)&&(C.value=d),requestAnimationFrame(()=>{if(h.current||!C||(O==null?void 0:O.activeElement)!==C)return;let{selectionStart:k,selectionEnd:N}=C;Math.abs((N??0)-(k??0))===0&&k===0&&C.setSelectionRange(C.value.length,C.value.length)}))},[P,a.comboboxState,O]),ge(([d],[$])=>{if(d===0&&$===1){if(h.current)return;let E=a.inputRef.current;if(!E)return;let _=E.value,{selectionStart:C,selectionEnd:k,selectionDirection:N}=E;E.value="",E.value=_,N!==null?E.setSelectionRange(C,k,N):E.setSelectionRange(C,k)}},[a.comboboxState]);let z=f.useRef(!1),V=x(()=>{z.current=!0}),K=x(()=>{M.nextFrame(()=>{z.current=!1})}),U=x(d=>{switch(h.current=!0,d.key){case L.Enter:if(h.current=!1,a.comboboxState!==0||z.current)return;if(d.preventDefault(),d.stopPropagation(),a.activeOptionIndex===null){b.closeCombobox();return}b.selectActiveOption(),a.mode===0&&b.closeCombobox();break;case L.ArrowDown:return h.current=!1,d.preventDefault(),d.stopPropagation(),H(a.comboboxState,{0:()=>b.goToOption(T.Next),1:()=>b.openCombobox()});case L.ArrowUp:return h.current=!1,d.preventDefault(),d.stopPropagation(),H(a.comboboxState,{0:()=>b.goToOption(T.Previous),1:()=>{b.openCombobox(),M.nextFrame(()=>{a.value||b.goToOption(T.Last)})}});case L.Home:if(d.shiftKey)break;return h.current=!1,d.preventDefault(),d.stopPropagation(),b.goToOption(T.First);case L.PageUp:return h.current=!1,d.preventDefault(),d.stopPropagation(),b.goToOption(T.First);case L.End:if(d.shiftKey)break;return h.current=!1,d.preventDefault(),d.stopPropagation(),b.goToOption(T.Last);case L.PageDown:return h.current=!1,d.preventDefault(),d.stopPropagation(),b.goToOption(T.Last);case L.Escape:return h.current=!1,a.comboboxState!==0?void 0:(d.preventDefault(),a.optionsRef.current&&!a.optionsPropsRef.current.static&&d.stopPropagation(),a.nullable&&a.mode===0&&a.value===null&&w(),b.closeCombobox());case L.Tab:if(h.current=!1,a.comboboxState!==0)return;a.mode===0&&a.activationTrigger!==1&&b.selectActiveOption(),b.closeCombobox();break}}),X=x(d=>{s==null||s(d),a.nullable&&a.mode===0&&d.target.value===""&&w(),b.openCombobox()}),y=x(d=>{var $,E,_;let C=($=d.relatedTarget)!=null?$:he.find(k=>k!==d.currentTarget);if(h.current=!1,!((E=a.optionsRef.current)!=null&&E.contains(C))&&!((_=a.buttonRef.current)!=null&&_.contains(C))&&a.comboboxState===0)return d.preventDefault(),a.mode===0&&(a.nullable&&a.value===null?w():a.activationTrigger!==1&&b.selectActiveOption()),b.closeCombobox()}),S=x(d=>{var $,E,_;let C=($=d.relatedTarget)!=null?$:he.find(k=>k!==d.currentTarget);(E=a.buttonRef.current)!=null&&E.contains(C)||(_=a.optionsRef.current)!=null&&_.contains(C)||a.disabled||a.immediate&&a.comboboxState!==0&&(b.openCombobox(),M.nextFrame(()=>{b.setActivationTrigger(1)}))}),A=de(()=>{if(a.labelId)return[a.labelId].join(" ")},[a.labelId]),re=f.useMemo(()=>({open:a.comboboxState===0,disabled:a.disabled}),[a]),ie={ref:g,id:c,role:"combobox",type:v,"aria-controls":(e=a.optionsRef.current)==null?void 0:e.id,"aria-expanded":a.comboboxState===0,"aria-activedescendant":a.activeOptionIndex===null?void 0:a.virtual?(n=a.options.find(d=>{var $;return!(($=a.virtual)!=null&&$.disabled(d.dataRef.current.value))&&a.compare(d.dataRef.current.value,a.virtual.options[a.activeOptionIndex])}))==null?void 0:n.id:(r=a.options[a.activeOptionIndex])==null?void 0:r.id,"aria-labelledby":A,"aria-autocomplete":"list",defaultValue:(l=(o=t.defaultValue)!=null?o:a.defaultValue!==void 0?p==null?void 0:p(a.defaultValue):null)!=null?l:a.defaultValue,disabled:a.disabled,onCompositionStart:V,onCompositionEnd:K,onKeyDown:U,onChange:X,onFocus:S,onBlur:y};return W({ourProps:ie,theirProps:R,slot:re,defaultTag:mt,name:"Combobox.Input"})}let ht="button";function xt(t,i){var e;let n=B("Combobox.Button"),r=Q("Combobox.Button"),o=Y(n.buttonRef,i),l=G(),{id:u=`headlessui-combobox-button-${l}`,...c}=t,s=ce(),p=x(g=>{switch(g.key){case L.ArrowDown:return g.preventDefault(),g.stopPropagation(),n.comboboxState===1&&r.openCombobox(),s.nextFrame(()=>{var O;return(O=n.inputRef.current)==null?void 0:O.focus({preventScroll:!0})});case L.ArrowUp:return g.preventDefault(),g.stopPropagation(),n.comboboxState===1&&(r.openCombobox(),s.nextFrame(()=>{n.value||r.goToOption(T.Last)})),s.nextFrame(()=>{var O;return(O=n.inputRef.current)==null?void 0:O.focus({preventScroll:!0})});case L.Escape:return n.comboboxState!==0?void 0:(g.preventDefault(),n.optionsRef.current&&!n.optionsPropsRef.current.static&&g.stopPropagation(),r.closeCombobox(),s.nextFrame(()=>{var O;return(O=n.inputRef.current)==null?void 0:O.focus({preventScroll:!0})}));default:return}}),v=x(g=>{if(Be(g.currentTarget))return g.preventDefault();n.comboboxState===0?r.closeCombobox():(g.preventDefault(),r.openCombobox()),s.nextFrame(()=>{var O;return(O=n.inputRef.current)==null?void 0:O.focus({preventScroll:!0})})}),R=de(()=>{if(n.labelId)return[n.labelId,u].join(" ")},[n.labelId,u]),a=f.useMemo(()=>({open:n.comboboxState===0,disabled:n.disabled,value:n.value}),[n]),b={ref:o,id:u,type:ot(t,n.buttonRef),tabIndex:-1,"aria-haspopup":"listbox","aria-controls":(e=n.optionsRef.current)==null?void 0:e.id,"aria-expanded":n.comboboxState===0,"aria-labelledby":R,disabled:n.disabled,onClick:v,onKeyDown:p};return W({ourProps:b,theirProps:c,slot:a,defaultTag:ht,name:"Combobox.Button"})}let Ot="label";function It(t,i){let e=G(),{id:n=`headlessui-combobox-label-${e}`,...r}=t,o=B("Combobox.Label"),l=Q("Combobox.Label"),u=Y(o.labelRef,i);F(()=>l.registerLabel(n),[n]);let c=x(()=>{var p;return(p=o.inputRef.current)==null?void 0:p.focus({preventScroll:!0})}),s=f.useMemo(()=>({open:o.comboboxState===0,disabled:o.disabled}),[o]);return W({ourProps:{ref:u,id:n,onClick:c},theirProps:r,slot:s,defaultTag:Ot,name:"Combobox.Label"})}let St="ul",Rt=be.RenderStrategy|be.Static;function yt(t,i){let e=G(),{id:n=`headlessui-combobox-options-${e}`,hold:r=!1,...o}=t,l=B("Combobox.Options"),u=Y(l.optionsRef,i),c=Ae(),s=(()=>c!==null?(c&te.Open)===te.Open:l.comboboxState===0)();F(()=>{var a;l.optionsPropsRef.current.static=(a=t.static)!=null?a:!1},[l.optionsPropsRef,t.static]),F(()=>{l.optionsPropsRef.current.hold=r},[l.optionsPropsRef,r]),it({container:l.optionsRef.current,enabled:l.comboboxState===0,accept(a){return a.getAttribute("role")==="option"?NodeFilter.FILTER_REJECT:a.hasAttribute("role")?NodeFilter.FILTER_SKIP:NodeFilter.FILTER_ACCEPT},walk(a){a.setAttribute("role","none")}});let p=de(()=>{var a,b;return(b=l.labelId)!=null?b:(a=l.buttonRef.current)==null?void 0:a.id},[l.labelId,l.buttonRef.current]),v=f.useMemo(()=>({open:l.comboboxState===0,option:void 0}),[l]),R={"aria-labelledby":p,role:"listbox","aria-multiselectable":l.mode===1?!0:void 0,id:n,ref:u};return l.virtual&&l.comboboxState===0&&Object.assign(o,{children:j.createElement(ft,null,o.children)}),W({ourProps:R,theirProps:o,slot:v,defaultTag:St,features:Rt,visible:s,name:"Combobox.Options"})}let Ct="li";function Tt(t,i){var e;let n=G(),{id:r=`headlessui-combobox-option-${n}`,disabled:o=!1,value:l,order:u=null,...c}=t,s=B("Combobox.Option"),p=Q("Combobox.Option"),v=s.virtual?s.activeOptionIndex===s.calculateIndex(l):s.activeOptionIndex===null?!1:((e=s.options[s.activeOptionIndex])==null?void 0:e.id)===r,R=s.isSelected(l),a=f.useRef(null),b=Se({disabled:o,value:l,domRef:a,order:u}),g=f.useContext(Ee),O=Y(i,a,g?g.measureElement:null),h=x(()=>p.onChange(l));F(()=>p.registerOption(r,b),[b,r]);let M=f.useRef(!(s.virtual||s.__demoMode));F(()=>{if(!s.virtual||!s.__demoMode)return;let y=me();return y.requestAnimationFrame(()=>{M.current=!0}),y.dispose},[s.virtual,s.__demoMode]),F(()=>{if(!M.current||s.comboboxState!==0||!v||s.activationTrigger===0)return;let y=me();return y.requestAnimationFrame(()=>{var S,A;(A=(S=a.current)==null?void 0:S.scrollIntoView)==null||A.call(S,{block:"nearest"})}),y.dispose},[a,v,s.comboboxState,s.activationTrigger,s.activeOptionIndex]);let w=x(y=>{var S;if(o||(S=s.virtual)!=null&&S.disabled(l))return y.preventDefault();h(),Ve()||requestAnimationFrame(()=>{var A;return(A=s.inputRef.current)==null?void 0:A.focus({preventScroll:!0})}),s.mode===0&&requestAnimationFrame(()=>p.closeCombobox())}),P=x(()=>{var y;if(o||(y=s.virtual)!=null&&y.disabled(l))return p.goToOption(T.Nothing);let S=s.calculateIndex(l);p.goToOption(T.Specific,S)}),z=rt(),V=x(y=>z.update(y)),K=x(y=>{var S;if(!z.wasMoved(y)||o||(S=s.virtual)!=null&&S.disabled(l)||v)return;let A=s.calculateIndex(l);p.goToOption(T.Specific,A,0)}),U=x(y=>{var S;z.wasMoved(y)&&(o||(S=s.virtual)!=null&&S.disabled(l)||v&&(s.optionsPropsRef.current.hold||p.goToOption(T.Nothing)))}),X=f.useMemo(()=>({active:v,selected:R,disabled:o}),[v,R,o]);return W({ourProps:{id:r,ref:O,role:"option",tabIndex:o===!0?void 0:-1,"aria-disabled":o===!0?!0:void 0,"aria-selected":R,disabled:void 0,onClick:w,onFocus:P,onPointerEnter:V,onMouseEnter:V,onPointerMove:K,onMouseMove:K,onPointerLeave:U,onMouseLeave:U},theirProps:c,slot:X,defaultTag:Ct,name:"Combobox.Option"})}let Et=J(bt),Mt=J(xt),wt=J(gt),$t=J(It),Pt=J(yt),zt=J(Tt),kt=Object.assign(Et,{Input:wt,Button:Mt,Label:$t,Options:Pt,Option:zt});export{ot as T,kt as q};
